# Detailed notes about K6 


## Structure of K6 projects
* **Default function:** This is where the test logic resides. It defines what your test will do and how it will behave during execution. For browser scripts, it’s written as an async function to handle browser actions.
* **Imports:** You can import additional k6 modules or JavaScript libraries (jslibs) to extend your script’s functionality, such as making HTTP requests. Note that k6 is not built upon Node.js, and instead uses its own JavaScript runtime. Compatibility with some npm modules may vary.
* **Options:** Enable you to configure the execution of the test, such as defining the number of virtual users, the test duration, or setting performance thresholds. Refer to Options for more details.
* **Lifecycle operations (optional):** Because your test might need to run code before and/or after the execution of the test logic, such as parsing data from a file, or download an object from Amazon S3, lifecycle operations allow you to write code, either as predefined functions or within specific code scopes, that will be executed at different stages of the test execution.

## Template test

To create the template test:
```bash
 k6 new --template browser browser-script.js
```
Running the tests:

```bash
 k6 run browser-script.js
```

## About the metrics generated by K6 

The k6 browser module emits metrics based on [Core Web Vitals](https://web.dev/articles/vitals?hl=pt-br#core-web-vitals).

The vitals are composed of three important metrics to help a user experience when using your web application:
- **Longest content display (LCP):** measures loading performance. To offer a good user experience, LCP needs to occur within 2.5 seconds of the page starting to load.
- **Interaction to Next Paint (INP):** measures interactivity. To offer a good user experience, pages need to have an INP of 200 milliseconds or fewer.
- **Cumulative Layout Shift (CLS):** measures visual stability. To offer a good user experience, pages need to maintain a CLS of 0.1 or less

These are the metrics that are stable now on the Core Web Vitals page; They help us understand which areas of our frontend application need optimization.

Existing browser measures, such as Load and DOMContentLoaded times, no longer accurately reflect user experience very well. Relying on these load events does not give the correct metric to analyze critical performance bottlenecks that your page might have. Google’s Web Vitals is a better measure of your page performance and its user experience



| Metric name | Description |
|-------------|-------------|
|   browser_web_vital_cls          |Measures the visual stability on a webpage by quantifying the amount of unexpected layout shift of visible page content. Refer to Cumulative Layout Shift for more information.  |
|    browser_web_vital_fid         |Measures the responsiveness of a web page by quantifying the delay between a user’s first interaction, such as clicking a button, and the browser’s response. Refer to First Input Delay for more information.             |
|      browser_web_vital_lcp       |Measures the time it takes for the largest content element on a page to become visible. Refer to Largest Contentful Paint for more information.             |


K6 provides more metrics and the possibility of creating your own metric. Read more [here](https://grafana.com/docs/k6/latest/using-k6-browser/metrics/).